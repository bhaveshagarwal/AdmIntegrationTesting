version: 0.1
component: build
timeoutInSeconds: 20000
runAs: root
shell: bash
env:
  exportedVariables:
   - version
steps:
  - type: Command
    name: "Check python and OCI CLI version"
    command: |
      which python
      python --version
      which python2
      python2 --version
      which python3
      python3 --version
      which oci
      oci -v
  - type: Command
    name: "Update yum and its dependencies"
    command: |
      yum update
      yum install openssl-devel bzip2-devel libffi-devel
      yum groupinstall "Development Tools"
  - type: Command
    name: "Install latest Python 3.10.7 and set that to default"
    command: |
      cd $HOME/agent
      wget https://www.python.org/ftp/python/3.10.7/Python-3.10.7.tgz
      tar -xzf Python-3.10.7.tgz
      cd Python-3.10.7
      ./configure --enable-optimizations
      make altinstall
      which python3.10
      python3.10 -V
      update-alternatives --install /usr/bin/python python /usr/local/bin/python3.10
  - type: Command
    name: "Check Python and OCI CLI versions now"
    command: |
      which python
      python --version
      which python2
      python2 --version
      which python3
      python3 -v
      which oci
      oci -v
